<header class="concept-header">
    <span>Create a new concept</span>
</header>

<section>
    <form name="conceptNewForm" ng-submit="submitNewConcept(conceptNewForm.$valid)" novalidate>
        <fieldset class="conceptNewForm">

            <div class="field">
                <label for="conceptName">Concept Name</label>
                <input
                    name="conceptName"
                    type="text"
                    id="conceptName"
                    placeholder="Enter a concept name"
                    ng-model="form.conceptName"
                    autocapitalize="off"
                    autocorrect="off"
                    autofocus="autofocus"
                    required
                />
                <!-- <div ng-messages="conceptNewForm.conceptName.$error" ng-if="conceptNewForm.conceptName.$dirty">
                    <small ng-message="required" class="error">A concept name is required.</small>
                </div> -->
            </div> <!-- /.field -->

            <div class="field">
                <label for="Categories">Categories</label>
                <!-- <input
                    name="Categories"
                    type="text"
                    id="Categories"
                    placeholder="Enter the concept display name"
                    ng-model="form.categories"
                    autocapitalize="off"
                    autocorrect="off"
                    autofocus="autofocus"
                    required
                /> -->

                <tag-input
                    id="categories-tag"
                    name="Categories"
                    ng-model="form.categories"
                    placeholder="Add a category"
                    ></tag-input> <!-- TODO autofocus -->

                <span>Categories: {{form.categories}}</span>
            </div> <!-- /.field -->

            <div id="field"> <!-- TODO Make this, and the lat/long into a directive -->
                <label for="geoCoordinates">GEO Coordinates</label>
                <input
                    name="geoCoordinates"
                    id="map-autocomplete"
                    placeholder="Autocomplete: Enter a place"
                    ng-model="form.address"
                    type="text"
                    autofocus="autofocus"></input>
            </div>
            <section id="disabled-lat-long" ng-if="place">
                <div class="lat-long-coordinates" id="field">
                    <label for="latitude">Latitude</label>
                    <input
                        name="latitude"
                        ng-model="form.latitude"
                        type="text"
                        autofocus="autofocus"
                        disabled></input>
                </div>
                <div class="lat-long-coordinates" id="field">
                    <label for="longitude">Longitude</label>
                    <input
                        name="longitude"
                        ng-model="form.longitude"
                        type="text"
                        autofocus="autofocus"
                        disabled></input>
                </div>
            </section>

            <div class="field">
                <label for="select">Concept Type</label>
                <select class="global-date-selector custom"
                    ng-model="form.entity"
                    ng-options="entityType.name for entityType in supportedEntities"
                    required
                    ></select>
            </div>

            <div class="field" ng-if="form.entity.name === 'Event'">
                <div class="field">
                    <label for="eventName">Event Name</label>
                    <input
                        name="eventName"
                        type="text"
                        id="eventName"
                        placeholder="Enter the event name"
                        ng-model="form.eventName"
                        autocapitalize="off"
                        autocorrect="off"
                        autofocus="autofocus"
                    />
                </div> <!-- /.field -->
            </div>

            <div class="field">
                <label for="select">Is Block Listed?</label>
                <select class="global-date-selector custom"
                    ng-model="form.blocked"
                    ng-options="blockType.name for blockType in blockedTypes"
                    required
                    ></select>
            </div>

            <div id="field">
                <label for="associatedform">Associated Forms</label>

                <div class="field related-forms" data-ng-repeat="associatedform in form.associatedForms"> <!-- TODO Make these into form directives -->
                    <!-- <section>
                        <span>Last entry for the form is always the same as the concept name. Disabled for editing.</span>
                    </section> -->
                    <fieldset class="form-field">
                        <label for="associatedform">Form Name</label>
                        <input type="text"
                            class="related-forms-item"
                            ng-model="associatedform.name"
                            name="associatedForm"
                            placeholder="Enter a form"
                            autocapitalize="off"
                            autocorrect="off"
                            autofocus="autofocus"
                             />

                        <label for="associatedform">Number of occurrences</label>
                        <input type="text"
                            class="related-forms-item"
                            ng-model="associatedform.occurenceCount"
                            name="associatedForm"
                            placeholder=""
                            autocapitalize="off"
                            autocorrect="off"
                            autofocus="autofocus"
                             />

                        <label for="associatedform">Number of times linked</label>
                        <input type="text"
                            class="related-forms-item"
                            ng-model="associatedform.linkedCount"
                            name="associatedForm"
                            placeholder=""
                            autocapitalize="off"
                            autocorrect="off"
                            autofocus="autofocus"
                             />

                        <label for="associatedform">Linked probability</label> <!-- TODO replace with sliders in its own section at the end of the form -->
                        <input type="text"
                            class="related-forms-item"
                            ng-model="associatedform.linkedProbability"
                            name="associatedForm"
                            placeholder="Between 0 and 1"
                            autocapitalize="off"
                            autocorrect="off"
                            autofocus="autofocus"
                             />
                    </fieldset>
                    <button class="delete-button" type="button" type="value" ng-click="deleteForm(associatedform)">-</button>
                </div> <!-- /.field -->

                <label for="associatedform">Default Associated Form (same as the concept name)</label>

                <div class="field related-forms"> <!-- The default form is the concept name. TODO include an extra field to start with an additional form -->
                        <!-- <label for="associatedform" ng-show="form.associatedForms.length === 0">Associated Forms</label> -->
                    <fieldset class="form-field">
                        <label for="associatedform">Form Name</label>
                        <input
                            class="related-forms-item"
                            name="relatedForms"
                            type="text"
                            id="relatedForms"
                            placeholder="Disabled: same as concept name"
                            ng-model="form.conceptName"
                            autocapitalize="off"
                            autocorrect="off"
                            autofocus="autofocus"
                            required
                            disabled
                        />

                        <label for="associatedform">Number of occurrences</label>
                        <input type="text"
                            class="related-forms-item"
                            ng-model="form.defaultForm.occurenceCount"
                            name="associatedForm"
                            placeholder=""
                            autocapitalize="off"
                            autocorrect="off"
                            autofocus="autofocus"
                            />

                        <label for="associatedform">Number of times linked</label>
                        <input type="text"
                            class="related-forms-item"
                            ng-model="form.defaultForm.linkedCount"
                            name="associatedForm"
                            placeholder=""
                            autocapitalize="off"
                            autocorrect="off"
                            autofocus="autofocus"
                            />

                        <label for="associatedform">Linked probability</label>
                        <input type="text"
                            class="related-forms-item"
                            ng-model="form.defaultForm.linkedProbability"
                            name="associatedForm"
                            placeholder="Between 0 and 1"
                            autocapitalize="off"
                            autocorrect="off"
                            autofocus="autofocus"
                            />
                    </fieldset>
                    <button type="button" ng-click="addForm()">+</button> <!-- TODO ng-click="addForm()" -->
                </div> <!-- /.field -->
            </div>

            <div class="field related-concepts" data-ng-repeat="relatedConcept in form.relatedConcepts">
                <label for="relatedConcept" ng-show="$first">Related Concepts</label>
                <input type="text"
                    class="related-concepts-item"
                    ng-model="relatedConcept.name"
                    name="relatedConcept"
                    placeholder="Enter the concept display name"
                    autocapitalize="off"
                    autocorrect="off"
                    autofocus="autofocus"
                    />
                <button class="delete-button" type="button" type="value" ng-show="!$last" ng-click="deleteConcept(relatedConcept)">-</button>
                <button type="button" type="value" ng-show="$last" ng-click="addConcept(relatedConcept)">+</button>
            </div> <!-- /.field -->

            <!-- <div class="field related-concepts">
                <label for="RelatedConcepts">Related Concepts</label>
                <input
                    class="related-concepts-item"
                    name="RelatedConcepts"
                    type="text"
                    id="RelatedConcepts"
                    placeholder="Enter the concept display name"
                    ng-model="form.relatedConcepts"
                    autocapitalize="off"
                    autocorrect="off"
                    autofocus="autofocus"
                    required
                />
                <button>+</button>
            </div> -->

            <div class="button-bar group">

                <div class="small-6">
                    <div class="row">
                        <div class="large-3 medium-5 columns">
                            <input
                                id="btn-submit"
                                type="submit"
                                value="Submit"
                                ng-disabled="conceptNewForm.$invalid"
                                class="button"
                            >
                        </div>
                    </div>
                </div>

            </div>

        </fieldset>
    </form>
</section>

<!--
TODO

Form to Concept link:

Sense probability
Number of occurrences

-->
